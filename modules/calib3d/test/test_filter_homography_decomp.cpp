/*M///////////////////////////////////////////////////////////////////////////////////////
//
//  IMPORTANT: READ BEFORE DOWNLOADING, COPYING, INSTALLING OR USING.
//
//  By downloading, copying, installing or using the software you agree to this license.
//  If you do not agree to this license, do not download, install,
//  copy or use the software.
//
//
//                           License Agreement
//                For Open Source Computer Vision Library
//
// Copyright (C) 2016, OpenCV Foundation, all rights reserved.
//
// Third party copyrights are property of their respective owners.
//
// Redistribution and use in source and binary forms, with or without modification,
// are permitted provided that the following conditions are met:
//
//   * Redistribution's of source code must retain the above copyright notice,
//     this list of conditions and the following disclaimer.
//
//   * Redistribution's in binary form must reproduce the above copyright notice,
//     this list of conditions and the following disclaimer in the documentation
//     and/or other materials provided with the distribution.
//
//   * The name of the copyright holders may not be used to endorse or promote products
//     derived from this software without specific prior written permission.
//
// This software is provided by the copyright holders and contributors "as is" and
// any express or implied warranties, including, but not limited to, the implied
// warranties of merchantability and fitness for a particular purpose are disclaimed.
// In no event shall the Intel Corporation or contributors be liable for any direct,
// indirect, incidental, special, exemplary, or consequential damages
// (including, but not limited to, procurement of substitute goods or services;
// loss of use, data, or profits; or business interruption) however caused
// and on any theory of liability, whether in contract, strict liability,
// or tort (including negligence or otherwise) arising in any way out of
// the use of this software, even if advised of the possibility of such damage.
//
//M*/

#include "test_precomp.hpp"
#include "opencv2/calib3d.hpp"

using namespace cv;
using namespace std;

class CV_FilterHomographyDecompTest : public cvtest::BaseTest {

public:
    CV_FilterHomographyDecompTest()
    {
        buildTestDataSet();
    }

protected:
    void run(int)
    {
        vector<int> finalSolutions;

        filterHomographyDecompByVisibleRefpoints(_rotations, _normals, _prevRectifiedPoints, _currRectifiedPoints, finalSolutions, _mask);

        //there should be at least 2 solution

        ASSERT_TRUE(isValidResult(finalSolutions));
    }

private:

    void buildTestDataSet()
    {
        double rotationsArray[4][9] = {
            {
                0.98811084196540500,
                -0.15276633082836735,
                0.017303530150126534,
                0.14161851662094097,
                0.94821044891315664,
                0.28432576443578628,
                -0.059842791884259422,
                -0.27849487021693553,
                0.95857156619751127
            },
            {
                0.98811084196540500,
                -0.15276633082836735,
                0.017303530150126534,
                0.14161851662094097,
                0.94821044891315664,
                0.28432576443578628,
                -0.059842791884259422,
                -0.27849487021693553,
                0.95857156619751127
            },
            {
                0.95471096402077438,
                -0.21080808634428211,
                -0.20996886890771557,
                0.20702063153797226,
                0.97751379914116743,
                -0.040115216641822840,
                0.21370407880090386,
                -0.0051694506925720751,
                0.97688476468997820
            },
            {
                0.95471096402077438,
                -0.21080808634428211,
                -0.20996886890771557,
                0.20702063153797226,
                0.97751379914116743,
                -0.040115216641822840,
                0.21370407880090386,
                -0.0051694506925720751,
                0.97688476468997820
            }
        };

        double normalsArray[4][3] = {
            {
                -0.023560516110791116,
                0.085818414407956692,
                0.99603217911325403
            },
            {
                0.023560516110791116,
                -0.085818414407956692,
                -0.99603217911325403
            },
            {
                -0.62483547397726014,
                -0.56011861446691769,
                0.54391889853844289
            },
            {
                0.62483547397726014,
                0.56011861446691769,
                -0.54391889853844289
            }
        };

        uint8_t maskArray[514] = { 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };

        Point2f currRectifiedPointArr[514] = {
            Point2f((float)-0.565732896, (float)-0.321162999),
            Point2f((float)-0.416198403, (float)-0.299646467),
            Point2f((float)-0.408354312, (float)-0.290387660),
            Point2f((float)-0.386555284, (float)-0.287677139),
            Point2f((float)-0.348475337, (float)-0.276208878),
            Point2f((float)-0.415957332, (float)-0.266133875),
            Point2f((float)-0.354961902, (float)-0.257545590),
            Point2f((float)-0.420189440, (float)-0.255190015),
            Point2f((float)-0.379785866, (float)-0.252570540),
            Point2f((float)-0.144345313, (float)-0.249134675),
            Point2f((float)-0.162417486, (float)-0.223227784),
            Point2f((float)-0.129876539, (float)-0.219722182),
            Point2f((float)-0.470801264, (float)-0.211166814),
            Point2f((float)0.0992607549, (float)-0.209064797),
            Point2f((float)0.123508267, (float)-0.196303099),
            Point2f((float)-0.521849990, (float)-0.190706849),
            Point2f((float)-0.513497114, (float)-0.189186409),
            Point2f((float)-0.534959674, (float)-0.185138911),
            Point2f((float)0.121614374, (float)-0.182721153),
            Point2f((float)0.154205695, (float)-0.183763996),
            Point2f((float)-0.516449869, (float)-0.181606859),
            Point2f((float)-0.523427486, (float)-0.180088669),
            Point2f((float)0.149494573, (float)-0.179563865),
            Point2f((float)-0.552187204, (float)-0.172630817),
            Point2f((float)-0.322249800, (float)-0.172333881),
            Point2f((float)0.127574071, (float)-0.165683150),
            Point2f((float)0.159817487, (float)-0.162389070),
            Point2f((float)-0.578930736, (float)-0.160272732),
            Point2f((float)-0.600617707, (float)-0.155920163),
            Point2f((float)-0.249115735, (float)-0.154711768),
            Point2f((float)-0.543279886, (float)-0.144873798),
            Point2f((float)-0.529992998, (float)-0.142433196),
            Point2f((float)0.0554505363, (float)-0.142878756),
            Point2f((float)-0.613355398, (float)-0.132748783),
            Point2f((float)0.190059289, (float)-0.128930226),
            Point2f((float)-0.255682647, (float)-0.127393380),
            Point2f((float)0.0299431719, (float)-0.125339776),
            Point2f((float)-0.282943249, (float)-0.118550651),
            Point2f((float)-0.0348402821, (float)-0.115398556),
            Point2f((float)-0.0362741761, (float)-0.110100254),
            Point2f((float)-0.319089264, (float)-0.104354575),
            Point2f((float)-0.0401916653, (float)-0.0852083191),
            Point2f((float)-0.372183621, (float)-0.0812346712),
            Point2f((float)-0.00707253255, (float)-0.0810251758),
            Point2f((float)0.267345309, (float)-0.0787685066),
            Point2f((float)0.258760840, (float)-0.0768160895),
            Point2f((float)-0.377273679, (float)-0.0763452053),
            Point2f((float)-0.0314898677, (float)-0.0743160769),
            Point2f((float)0.223423928, (float)-0.0724818707),
            Point2f((float)0.00284322398, (float)-0.0720727518),
            Point2f((float)0.232531011, (float)-0.0682833865),
            Point2f((float)0.282355100, (float)-0.0655683428),
            Point2f((float)-0.233353317, (float)-0.0613981225),
            Point2f((float)0.290982842, (float)-0.0607336313),
            Point2f((float)-0.0994169787, (float)-0.0376472026),
            Point2f((float)0.257561266, (float)-0.0331368558),
            Point2f((float)0.265076399, (float)-0.0320781991),
            Point2f((float)0.0454338901, (float)-0.0238198638),
            Point2f((float)0.0409987904, (float)-0.0186991505),
            Point2f((float)-0.502306283, (float)-0.0172236171),
            Point2f((float)-0.464807063, (float)-0.0149533665),
            Point2f((float)-0.185798749, (float)-0.00540314987),
            Point2f((float)0.182073534, (float)-0.000651287497),
            Point2f((float)-0.435764432, (float)0.00162558386),
            Point2f((float)-0.181552932, (float)0.00792864431),
            Point2f((float)-0.700565279, (float)0.0110246018),
            Point2f((float)-0.144087434, (float)0.0120453080),
            Point2f((float)-0.524990261, (float)0.0138590708),
            Point2f((float)-0.182723984, (float)0.0165519360),
            Point2f((float)-0.217308879, (float)0.0208590515),
            Point2f((float)0.462978750, (float)0.0247372910),
            Point2f((float)0.0956632495, (float)0.0323494300),
            Point2f((float)0.0843820646, (float)0.0424364135),
            Point2f((float)0.122466311, (float)0.0441578403),
            Point2f((float)-0.162433729, (float)0.0528083183),
            Point2f((float)0.0964344442, (float)0.0624147579),
            Point2f((float)-0.271349967, (float)0.0727724135),
            Point2f((float)-0.266336441, (float)0.0719895661),
            Point2f((float)0.0675768778, (float)0.0848240927),
            Point2f((float)-0.689944625, (float)0.0889045894),
            Point2f((float)-0.680990934, (float)0.0903657600),
            Point2f((float)-0.119472280, (float)0.0930491239),
            Point2f((float)-0.124393739, (float)0.0933082998),
            Point2f((float)-0.323403478, (float)0.0937438533),
            Point2f((float)-0.323273063, (float)0.0969979763),
            Point2f((float)-0.352427900, (float)0.101048596),
            Point2f((float)-0.327554941, (float)0.104539163),
            Point2f((float)-0.330044419, (float)0.114519835),
            Point2f((float)0.0235135648, (float)0.118004657),
            Point2f((float)-0.671623945, (float)0.130437061),
            Point2f((float)-0.385111898, (float)0.142786101),
            Point2f((float)-0.376281500, (float)0.145800456),
            Point2f((float)-0.0169987213, (float)0.148056105),
            Point2f((float)-0.326495141, (float)0.152596891),
            Point2f((float)-0.337120056, (float)0.154522225),
            Point2f((float)-0.336885720, (float)0.154304653),
            Point2f((float)0.322089493, (float)0.155130088),
            Point2f((float)-0.0713477954, (float)0.163638428),
            Point2f((float)-0.0208650175, (float)0.171433330),
            Point2f((float)-0.380652726, (float)0.172022790),
            Point2f((float)-0.0599780641, (float)0.182294667),
            Point2f((float)0.244408697, (float)0.194245726),
            Point2f((float)-0.101454332, (float)0.198159069),
            Point2f((float)0.257901788, (float)0.200226694),
            Point2f((float)-0.0775909275, (float)0.205242962),
            Point2f((float)0.231870517, (float)0.222396746),
            Point2f((float)-0.546760798, (float)0.242291704),
            Point2f((float)-0.538914979, (float)0.243761152),
            Point2f((float)0.206653103, (float)0.244874880),
            Point2f((float)-0.595693469, (float)0.264329463),
            Point2f((float)-0.581023335, (float)0.265664101),
            Point2f((float)0.00444878871, (float)0.267031074),
            Point2f((float)-0.573156178, (float)0.271591753),
            Point2f((float)-0.543381274, (float)0.271759123),
            Point2f((float)0.00450209389, (float)0.271335930),
            Point2f((float)-0.223618075, (float)0.278416723),
            Point2f((float)0.161934286, (float)0.289435983),
            Point2f((float)-0.199636295, (float)0.296817899),
            Point2f((float)-0.250217140, (float)0.299677849),
            Point2f((float)-0.258231103, (float)0.314012855),
            Point2f((float)-0.628315628, (float)0.316889286),
            Point2f((float)0.320948511, (float)0.316358119),
            Point2f((float)-0.246845752, (float)0.320511192),
            Point2f((float)0.0687271580, (float)0.321383297),
            Point2f((float)0.0784438103, (float)0.322898388),
            Point2f((float)0.0946765989, (float)0.325111747),
            Point2f((float)-0.249674007, (float)0.328731328),
            Point2f((float)-0.244633347, (float)0.329467386),
            Point2f((float)-0.245841011, (float)0.334985316),
            Point2f((float)0.118609101, (float)0.343532443),
            Point2f((float)0.0497615598, (float)0.348162144),
            Point2f((float)-0.221477821, (float)0.349263757),
            Point2f((float)0.0759577379, (float)0.351840734),
            Point2f((float)0.0504637137, (float)0.373238713),
            Point2f((float)0.0730970055, (float)0.376537383),
            Point2f((float)-0.204333842, (float)0.381100655),
            Point2f((float)-0.557245076, (float)-0.339432925),
            Point2f((float)-0.402010202, (float)-0.288829565),
            Point2f((float)-0.350465477, (float)-0.281259984),
            Point2f((float)-0.352995187, (float)-0.264569730),
            Point2f((float)-0.466762394, (float)-0.217114508),
            Point2f((float)0.152002022, (float)-0.217566550),
            Point2f((float)0.146226048, (float)-0.183914393),
            Point2f((float)0.0949312001, (float)-0.177005857),
            Point2f((float)-0.211882949, (float)-0.175594494),
            Point2f((float)-0.531562269, (float)-0.173924312),
            Point2f((float)-0.0727246776, (float)-0.167270422),
            Point2f((float)0.0546481088, (float)-0.140193000),
            Point2f((float)-0.296819001, (float)-0.137850702),
            Point2f((float)-0.261863053, (float)-0.139540121),
            Point2f((float)0.187967837, (float)-0.131033540),
            Point2f((float)0.322852045, (float)-0.112108752),
            Point2f((float)-0.0432251953, (float)-0.102951847),
            Point2f((float)-0.0453428440, (float)-0.0914504975),
            Point2f((float)-0.0182842426, (float)-0.0918859020),
            Point2f((float)0.0140433423, (float)-0.0904538929),
            Point2f((float)-0.377287626, (float)-0.0817026496),
            Point2f((float)0.266108125, (float)-0.0797783583),
            Point2f((float)0.257961422, (float)-0.0767710134),
            Point2f((float)-0.495943695, (float)-0.0683977529),
            Point2f((float)0.231466040, (float)-0.0675206482),
            Point2f((float)-0.240675926, (float)-0.0551427566),
            Point2f((float)-0.482824773, (float)-0.0510699376),
            Point2f((float)-0.491354793, (float)-0.0414650664),
            Point2f((float)-0.0960614979, (float)-0.0377000235),
            Point2f((float)-0.102409534, (float)-0.0369749814),
            Point2f((float)-0.471273214, (float)-0.0325376652),
            Point2f((float)-0.483320534, (float)-0.0174943600),
            Point2f((float)-0.457503378, (float)-0.0152483145),
            Point2f((float)-0.178161725, (float)-0.0153892851),
            Point2f((float)-0.483233035, (float)-0.0106405178),
            Point2f((float)-0.472914547, (float)-0.0105228210),
            Point2f((float)-0.166542307, (float)-0.00667150877),
            Point2f((float)0.181261331, (float)-0.00449455017),
            Point2f((float)-0.474292487, (float)-0.00428914558),
            Point2f((float)-0.185297221, (float)-0.00575157674),
            Point2f((float)-0.494381040, (float)-0.00278507406),
            Point2f((float)-0.141748473, (float)-0.00289725070),
            Point2f((float)-0.487515569, (float)0.000758233888),
            Point2f((float)0.322646528, (float)0.0197495818),
            Point2f((float)0.142943904, (float)0.0276249554),
            Point2f((float)-0.563232243, (float)0.0306834858),
            Point2f((float)-0.555995941, (float)0.0367121249),
            Point2f((float)0.114935011, (float)0.0496927276),
            Point2f((float)-0.152954608, (float)0.0538645200),
            Point2f((float)-0.594885707, (float)0.0562511310),
            Point2f((float)0.0678326488, (float)0.0756176412),
            Point2f((float)-0.667605639, (float)0.0828208700),
            Point2f((float)-0.354470938, (float)0.101424232),
            Point2f((float)0.0228204262, (float)0.120382607),
            Point2f((float)-0.639557123, (float)0.124422595),
            Point2f((float)-0.690505445, (float)0.126883239),
            Point2f((float)-0.395509213, (float)0.130242139),
            Point2f((float)-0.00618012529, (float)0.139929801),
            Point2f((float)0.175945997, (float)0.140235618),
            Point2f((float)0.198833048, (float)0.167587668),
            Point2f((float)-0.334679037, (float)0.177859858),
            Point2f((float)0.236127406, (float)0.192743436),
            Point2f((float)0.283146858, (float)0.204260647),
            Point2f((float)-0.0354267135, (float)0.206209183),
            Point2f((float)0.247388184, (float)0.207016930),
            Point2f((float)-0.0422560424, (float)0.212493256),
            Point2f((float)0.261681855, (float)0.215763748),
            Point2f((float)0.207528576, (float)0.219807997),
            Point2f((float)-0.300219178, (float)0.221922547),
            Point2f((float)0.206393883, (float)0.245171010),
            Point2f((float)0.239619836, (float)0.244768366),
            Point2f((float)-0.523026288, (float)0.250639766),
            Point2f((float)-0.591975033, (float)0.254252791),
            Point2f((float)0.246785000, (float)0.252878994),
            Point2f((float)0.272995651, (float)0.255815417),
            Point2f((float)0.00825022161, (float)0.265591830),
            Point2f((float)0.192723796, (float)0.266924977),
            Point2f((float)-0.222951472, (float)0.290150762),
            Point2f((float)-0.545146644, (float)0.304910392),
            Point2f((float)0.131736591, (float)0.319247276),
            Point2f((float)0.319435924, (float)0.317917794),
            Point2f((float)0.0687546134, (float)0.321296155),
            Point2f((float)-0.255853772, (float)0.327258259),
            Point2f((float)0.0948092714, (float)0.325284332),
            Point2f((float)0.104488030, (float)0.327628911),
            Point2f((float)-0.245483562, (float)0.327617317),
            Point2f((float)0.0647632629, (float)0.363111496),
            Point2f((float)-0.382861346, (float)-0.287226975),
            Point2f((float)-0.354297429, (float)-0.278708905),
            Point2f((float)-0.356116027, (float)-0.262691110),
            Point2f((float)-0.369049937, (float)-0.237850189),
            Point2f((float)-0.146217853, (float)-0.233530551),
            Point2f((float)0.102752604, (float)-0.223108903),
            Point2f((float)0.137545392, (float)-0.218163848),
            Point2f((float)0.125815898, (float)-0.216970086),
            Point2f((float)-0.557826996, (float)-0.194665924),
            Point2f((float)-0.533946335, (float)-0.184958249),
            Point2f((float)0.0976954028, (float)-0.173691019),
            Point2f((float)-0.240166873, (float)-0.160652772),
            Point2f((float)0.166464865, (float)-0.154563308),
            Point2f((float)-0.0330923162, (float)-0.125799045),
            Point2f((float)-0.290044904, (float)-0.118914597),
            Point2f((float)0.00350888353, (float)-0.108661920),
            Point2f((float)-0.0109116854, (float)-0.106212743),
            Point2f((float)-0.0298740193, (float)-0.102953635),
            Point2f((float)-0.287203342, (float)-0.0997403413),
            Point2f((float)-0.269498408, (float)-0.0981520712),
            Point2f((float)-0.000815737061, (float)-0.0938294530),
            Point2f((float)0.274663270, (float)-0.0844340026),
            Point2f((float)-0.371082008, (float)-0.0805466920),
            Point2f((float)-0.368196100, (float)-0.0743779093),
            Point2f((float)0.00675902702, (float)-0.0735078678),
            Point2f((float)0.226267770, (float)-0.0744194537),
            Point2f((float)-0.241736412, (float)-0.0630025938),
            Point2f((float)-0.408663541, (float)-0.0564615242),
            Point2f((float)0.251640886, (float)-0.0519632548),
            Point2f((float)0.249993712, (float)-0.0519672707),
            Point2f((float)-0.426033378, (float)-0.0365641154),
            Point2f((float)-0.467352122, (float)-0.0305716563),
            Point2f((float)0.251341015, (float)-0.0268137120),
            Point2f((float)-0.443456501, (float)-0.0243669953),
            Point2f((float)-0.502199471, (float)-0.0151771074),
            Point2f((float)-0.178487480, (float)-0.0155749097),
            Point2f((float)0.178145915, (float)-0.00528379623),
            Point2f((float)-0.492981344, (float)-0.00174682145),
            Point2f((float)-0.150337398, (float)0.000692513015),
            Point2f((float)-0.457302928, (float)0.00352234906),
            Point2f((float)0.190587431, (float)0.00151424226),
            Point2f((float)-0.482671946, (float)0.00682042213),
            Point2f((float)-0.158589542, (float)0.0150188655),
            Point2f((float)-0.182223722, (float)0.0145649035),
            Point2f((float)0.107089065, (float)0.0223725326),
            Point2f((float)0.135399371, (float)0.0275243558),
            Point2f((float)-0.552838683, (float)0.0275048595),
            Point2f((float)-0.432176501, (float)0.0248741303),
            Point2f((float)-0.192510992, (float)0.0281074084),
            Point2f((float)-0.553043425, (float)0.0298770685),
            Point2f((float)-0.684887648, (float)0.0436144769),
            Point2f((float)0.0850105733, (float)0.0448755622),
            Point2f((float)-0.165784389, (float)0.0439001285),
            Point2f((float)0.102653719, (float)0.0457992665),
            Point2f((float)0.114853017, (float)0.0504316092),
            Point2f((float)-0.647432685, (float)0.0608204119),
            Point2f((float)0.0828530043, (float)0.0608987175),
            Point2f((float)0.0894377902, (float)0.0742467493),
            Point2f((float)0.0702404827, (float)0.0767309442),
            Point2f((float)-0.613642335, (float)0.0779517740),
            Point2f((float)-0.670592189, (float)0.0849624202),
            Point2f((float)-0.395209312, (float)0.0854151621),
            Point2f((float)0.125186160, (float)0.0919951499),
            Point2f((float)-0.359707922, (float)0.102121405),
            Point2f((float)-0.354259193, (float)0.101300709),
            Point2f((float)0.0304000825, (float)0.110619470),
            Point2f((float)-0.677573025, (float)0.114422500),
            Point2f((float)0.0305799693, (float)0.121603437),
            Point2f((float)-0.358950615, (float)0.121660560),
            Point2f((float)-0.718753040, (float)0.134569481),
            Point2f((float)0.256451160, (float)0.141883001),
            Point2f((float)-0.0904129520, (float)0.146879435),
            Point2f((float)-0.0184279438, (float)0.148968369),
            Point2f((float)-0.356992692, (float)0.160104826),
            Point2f((float)-0.337676436, (float)0.161766291),
            Point2f((float)0.201174691, (float)0.169025913),
            Point2f((float)-0.378423393, (float)0.170933828),
            Point2f((float)-0.601599216, (float)0.174998865),
            Point2f((float)-0.0902864039, (float)0.184311926),
            Point2f((float)-0.0584819093, (float)0.184186250),
            Point2f((float)0.294467270, (float)0.182560727),
            Point2f((float)0.250262231, (float)0.186239958),
            Point2f((float)-0.326370239, (float)0.191697389),
            Point2f((float)-0.0980727375, (float)0.196913749),
            Point2f((float)0.253085673, (float)0.201914877),
            Point2f((float)-0.0344332159, (float)0.205900863),
            Point2f((float)0.255287141, (float)0.203029931),
            Point2f((float)-0.452713937, (float)0.205191836),
            Point2f((float)0.264822274, (float)0.217408702),
            Point2f((float)-0.0290334225, (float)0.221684650),
            Point2f((float)-0.583990574, (float)0.237398431),
            Point2f((float)-0.145020664, (float)0.240374506),
            Point2f((float)0.249667659, (float)0.254706532),
            Point2f((float)0.274279058, (float)0.256447285),
            Point2f((float)-0.282936275, (float)0.259140193),
            Point2f((float)0.241211995, (float)0.260401577),
            Point2f((float)-0.590560019, (float)0.272659779),
            Point2f((float)-0.574947417, (float)0.272671998),
            Point2f((float)-0.224780366, (float)0.279990941),
            Point2f((float)-0.525540829, (float)0.287235677),
            Point2f((float)-0.247069210, (float)0.298608154),
            Point2f((float)-0.201292604, (float)0.298156679),
            Point2f((float)0.319822490, (float)0.317605704),
            Point2f((float)-0.248013541, (float)0.320789784),
            Point2f((float)0.0957527757, (float)0.326543272),
            Point2f((float)0.105006196, (float)0.328469753),
            Point2f((float)-0.264089525, (float)0.332354158),
            Point2f((float)-0.670460403, (float)0.339870930),
            Point2f((float)0.118318990, (float)0.345167071),
            Point2f((float)0.0737744719, (float)0.353734553),
            Point2f((float)0.0655663237, (float)0.361025929),
            Point2f((float)-0.306805104, (float)0.363820761),
            Point2f((float)0.0524423867, (float)0.371921480),
            Point2f((float)0.0713953897, (float)0.375074357),
            Point2f((float)-0.411387652, (float)-0.268335998),
            Point2f((float)-0.357590824, (float)-0.263346583),
            Point2f((float)-0.407676578, (float)-0.253785878),
            Point2f((float)0.0660323426, (float)-0.253718942),
            Point2f((float)-0.157670841, (float)-0.225629836),
            Point2f((float)0.170453921, (float)-0.220800355),
            Point2f((float)-0.475751191, (float)-0.209005311),
            Point2f((float)-0.331408232, (float)-0.203059763),
            Point2f((float)-0.173841938, (float)-0.199112654),
            Point2f((float)-0.503261328, (float)-0.193795130),
            Point2f((float)-0.532277644, (float)-0.190292686),
            Point2f((float)-0.0972326621, (float)-0.191563144),
            Point2f((float)-0.0692789108, (float)-0.172031537),
            Point2f((float)-0.318824291, (float)-0.169072524),
            Point2f((float)-0.576232314, (float)-0.162124678),
            Point2f((float)-0.0839322209, (float)-0.156304389),
            Point2f((float)-0.583625376, (float)-0.142171323),
            Point2f((float)-0.0546422042, (float)-0.135338858),
            Point2f((float)0.0501612425, (float)-0.132490858),
            Point2f((float)-0.645011544, (float)-0.111341864),
            Point2f((float)-0.0925374180, (float)-0.0483307689),
            Point2f((float)-0.444242209, (float)-0.0263337940),
            Point2f((float)0.0335495919, (float)-0.0281750113),
            Point2f((float)0.274629444, (float)-0.0259516705),
            Point2f((float)0.213774025, (float)-0.0240113474),
            Point2f((float)-0.194874078, (float)-0.0151330847),
            Point2f((float)0.175111562, (float)-0.00868577976),
            Point2f((float)-0.185011521, (float)-0.000680683181),
            Point2f((float)0.152071685, (float)0.0204544198),
            Point2f((float)0.321354061, (float)0.0199794695),
            Point2f((float)-0.192160159, (float)0.0275637116),
            Point2f((float)-0.189656645, (float)0.0275667012),
            Point2f((float)0.137452200, (float)0.0298070628),
            Point2f((float)-0.194602579, (float)0.0449027494),
            Point2f((float)-0.647751570, (float)0.0625102371),
            Point2f((float)0.124078721, (float)0.0639316663),
            Point2f((float)0.125849217, (float)0.0762147456),
            Point2f((float)-0.614036798, (float)0.0778791085),
            Point2f((float)-0.684063017, (float)0.0867959261),
            Point2f((float)-0.670344174, (float)0.0846142769),
            Point2f((float)-0.127689242, (float)0.0883567855),
            Point2f((float)0.123796627, (float)0.0907361880),
            Point2f((float)-0.356352538, (float)0.101948388),
            Point2f((float)-0.388843179, (float)0.110183217),
            Point2f((float)0.0316384435, (float)0.123791300),
            Point2f((float)-0.627986908, (float)0.146491125),
            Point2f((float)-0.0747071728, (float)0.158135459),
            Point2f((float)-0.0235102437, (float)0.168867558),
            Point2f((float)-0.0903210714, (float)0.184088305),
            Point2f((float)0.292073458, (float)0.183571488),
            Point2f((float)-0.0585953295, (float)0.184784085),
            Point2f((float)-0.0317775607, (float)0.218368888),
            Point2f((float)0.209752038, (float)0.223883361),
            Point2f((float)-0.295424402, (float)0.229150623),
            Point2f((float)-0.144439027, (float)0.237902716),
            Point2f((float)-0.284140587, (float)0.262761474),
            Point2f((float)0.289083928, (float)0.276900887),
            Point2f((float)0.159017235, (float)0.300793648),
            Point2f((float)-0.204925507, (float)0.298536539),
            Point2f((float)-0.544958472, (float)0.305164427),
            Point2f((float)-0.261615157, (float)0.306550682),
            Point2f((float)0.0977220088, (float)0.327949613),
            Point2f((float)0.109876208, (float)0.337665111),
            Point2f((float)-0.283918083, (float)0.347385526),
            Point2f((float)0.0436712503, (float)0.350702018),
            Point2f((float)0.114512287, (float)0.367949426),
            Point2f((float)0.106543839, (float)0.375095814),
            Point2f((float)0.505324781, (float)-0.272183985),
            Point2f((float)0.0645913780, (float)-0.251512915),
            Point2f((float)-0.457196057, (float)-0.225893468),
            Point2f((float)-0.480293810, (float)-0.222602293),
            Point2f((float)-0.138176888, (float)-0.209798917),
            Point2f((float)-0.110901751, (float)-0.198036820),
            Point2f((float)-0.196451947, (float)-0.191723794),
            Point2f((float)-0.537742376, (float)-0.174413025),
            Point2f((float)-0.0650562346, (float)-0.174762890),
            Point2f((float)-0.567489207, (float)-0.165461496),
            Point2f((float)0.0879585966, (float)-0.163023785),
            Point2f((float)-0.303777844, (float)-0.142031133),
            Point2f((float)0.199195996, (float)-0.141861767),
            Point2f((float)0.0491657220, (float)-0.132264882),
            Point2f((float)-0.497363061, (float)-0.107934952),
            Point2f((float)-0.000536393432, (float)-0.102828167),
            Point2f((float)0.0155952247, (float)-0.0998895392),
            Point2f((float)-0.363601953, (float)-0.0897399634),
            Point2f((float)-0.224325985, (float)-0.0719678402),
            Point2f((float)-0.0638299435, (float)-0.0646244809),
            Point2f((float)-0.108656809, (float)-0.0468749776),
            Point2f((float)-0.0865045264, (float)-0.0512534790),
            Point2f((float)-0.469339728, (float)-0.0279338267),
            Point2f((float)0.0578282699, (float)-0.0133374622),
            Point2f((float)-0.195265710, (float)-0.0115369316),
            Point2f((float)0.296735317, (float)-0.0132813146),
            Point2f((float)0.0664219409, (float)0.0134935537),
            Point2f((float)0.126060545, (float)0.0333039127),
            Point2f((float)0.139887005, (float)0.0334976614),
            Point2f((float)-0.547339618, (float)0.0433730707),
            Point2f((float)0.0866046399, (float)0.0527233221),
            Point2f((float)0.131943896, (float)0.0657638907),
            Point2f((float)-0.280056775, (float)0.0685855150),
            Point2f((float)0.0746403933, (float)0.0795079395),
            Point2f((float)0.125382811, (float)0.0822770745),
            Point2f((float)-0.648187757, (float)0.103887804),
            Point2f((float)-0.107411072, (float)0.107508548),
            Point2f((float)0.0155869983, (float)0.108978622),
            Point2f((float)0.0189307462, (float)0.129617691),
            Point2f((float)0.162685350, (float)0.127225950),
            Point2f((float)-0.0875291452, (float)0.142281070),
            Point2f((float)0.319728941, (float)0.148827255),
            Point2f((float)-0.0259547811, (float)0.169724479),
            Point2f((float)0.259297132, (float)0.190075457),
            Point2f((float)-0.467013776, (float)0.212794706),
            Point2f((float)-0.315732479, (float)0.219243437),
            Point2f((float)-0.111042649, (float)0.217940107),
            Point2f((float)0.239550352, (float)0.222786069),
            Point2f((float)0.263966352, (float)0.260309041),
            Point2f((float)0.320023954, (float)-0.222228840),
            Point2f((float)-0.322707742, (float)-0.213004455),
            Point2f((float)-0.224977970, (float)-0.169595599),
            Point2f((float)-0.605799317, (float)-0.142425537),
            Point2f((float)0.0454332717, (float)-0.129945949),
            Point2f((float)0.205748767, (float)-0.113405459),
            Point2f((float)0.317985803, (float)-0.118630089),
            Point2f((float)0.497755647, (float)-0.0962266177),
            Point2f((float)-0.393495560, (float)-0.0904672816),
            Point2f((float)0.240035087, (float)-0.0737613589),
            Point2f((float)-0.212947786, (float)-0.0280145984),
            Point2f((float)0.0674179196, (float)0.0124880793),
            Point2f((float)-0.545862198, (float)0.0207057912),
            Point2f((float)-0.284409463, (float)0.0626631007),
            Point2f((float)-0.107082598, (float)0.0854173824),
            Point2f((float)0.0578137375, (float)0.0917839557),
            Point2f((float)0.145844117, (float)0.102937251),
            Point2f((float)0.183878779, (float)0.119614877),
            Point2f((float)-0.626380265, (float)0.140862882),
            Point2f((float)-0.0325521491, (float)0.161834121),
            Point2f((float)-0.590211987, (float)0.167720392),
            Point2f((float)0.289599866, (float)0.186565816),
            Point2f((float)-0.328821093, (float)0.187714070),
            Point2f((float)-0.289086968, (float)0.205165654),
            Point2f((float)-0.445392698, (float)0.215343162),
            Point2f((float)0.173715711, (float)0.273563296),
            Point2f((float)0.284015119, (float)0.270610362),
            Point2f((float)0.0174398609, (float)0.283809274),
            Point2f((float)-0.496335506, (float)-0.202981815),
            Point2f((float)0.0389454551, (float)-0.166210428),
            Point2f((float)-0.317301393, (float)-0.156280205),
            Point2f((float)-0.396320462, (float)-0.0949599668),
            Point2f((float)-0.213638976, (float)-0.0776446015),
            Point2f((float)0.497601509, (float)-0.0928353444),
            Point2f((float)-0.260220319, (float)-0.0718628615),
            Point2f((float)-0.116495222, (float)-0.0543703064),
            Point2f((float)-0.118132629, (float)-0.0156126227),
            Point2f((float)0.0242815297, (float)0.00629332382),
            Point2f((float)-0.537928998, (float)0.00815516617),
            Point2f((float)0.317720622, (float)0.0271231923),
            Point2f((float)-0.582170665, (float)0.0478387438),
            Point2f((float)-0.536856830, (float)0.0466793887),
            Point2f((float)-0.220819592, (float)0.0433096550),
            Point2f((float)-0.246473342, (float)0.0572598167),
            Point2f((float)0.481240988, (float)0.0503845438),
            Point2f((float)-0.102453016, (float)0.0649363101),
            Point2f((float)-0.149955124, (float)0.0744054317),
            Point2f((float)-0.248215869, (float)0.0916868672),
            Point2f((float)-0.101221249, (float)0.110788561),
            Point2f((float)-0.437672526, (float)0.179065496),
            Point2f((float)-0.0383506976, (float)0.183546484),
            Point2f((float)-0.279600590, (float)0.208760634),
            Point2f((float)0.182261929, (float)0.275244594),
            Point2f((float)0.0253023170, (float)-0.170456246),
            Point2f((float)-0.476852804, (float)-0.123630777),
            Point2f((float)-0.0803126246, (float)-0.0782076195),
            Point2f((float)-0.133338496, (float)-0.0659459904),
            Point2f((float)-0.0822777376, (float)-0.00390591589),
            Point2f((float)0.149250969, (float)0.104314201),
            Point2f((float)0.0418044887, (float)0.149009049),
            Point2f((float)-0.438308835, (float)0.164682120)
        };

        vector<Point2f> currRectifiedPoints(currRectifiedPointArr, currRectifiedPointArr + sizeof(currRectifiedPointArr) / sizeof(currRectifiedPointArr[0]));

        _currRectifiedPoints.swap(currRectifiedPoints);

        Point2f prevRectifiedPointArr[514] = {
            Point2f((float)-0.599324584, (float)-0.381164283),
            Point2f((float)-0.387985110, (float)-0.385367423),
            Point2f((float)-0.371437579, (float)-0.371891201),
            Point2f((float)-0.340867460, (float)-0.370632380),
            Point2f((float)-0.289822906, (float)-0.364118159),
            Point2f((float)-0.372411519, (float)-0.335272551),
            Point2f((float)-0.289586753, (float)-0.335766882),
            Point2f((float)-0.372335523, (float)-0.316857219),
            Point2f((float)-0.321099430, (float)-0.323233813),
            Point2f((float)0.208661616, (float)-0.153931335),
            Point2f((float)-0.559897065, (float)0.193362445),
            Point2f((float)0.0181128159, (float)-0.325224668),
            Point2f((float)-0.427504510, (float)0.105302416),
            Point2f((float)0.487470537, (float)-0.187071189),
            Point2f((float)0.343267351, (float)-0.339755565),
            Point2f((float)-0.477639943, (float)-0.204375938),
            Point2f((float)-0.466626763, (float)-0.204072326),
            Point2f((float)0.340813518, (float)-0.347292691),
            Point2f((float)0.342682719, (float)-0.320172101),
            Point2f((float)0.383663863, (float)-0.327343374),
            Point2f((float)-0.467062414, (float)-0.193995550),
            Point2f((float)-0.475603998, (float)-0.189820126),
            Point2f((float)0.552475691, (float)0.198386014),
            Point2f((float)-0.508027375, (float)-0.174297482),
            Point2f((float)-0.211989403, (float)-0.217261642),
            Point2f((float)0.180832058, (float)-0.127527758),
            Point2f((float)-0.112721168, (float)-0.125876635),
            Point2f((float)-0.112387165, (float)-0.167135969),
            Point2f((float)-0.562491000, (float)-0.140186235),
            Point2f((float)0.395156831, (float)-0.298828602),
            Point2f((float)-0.485202312, (float)-0.135626689),
            Point2f((float)0.148358017, (float)-0.195937276),
            Point2f((float)-0.248159677, (float)-0.254669130),
            Point2f((float)-0.568366945, (float)-0.105187029),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)-0.497599572, (float)-0.205334768),
            Point2f((float)-0.0948727652, (float)0.245045587),
            Point2f((float)0.160857186, (float)0.138075173),
            Point2f((float)0.164952606, (float)-0.195109487),
            Point2f((float)0.165254518, (float)-0.186554477),
            Point2f((float)-0.183777973, (float)-0.124357253),
            Point2f((float)0.166813776, (float)-0.153241888),
            Point2f((float)-0.241765827, (float)-0.0820638761),
            Point2f((float)0.208661616, (float)-0.153931335),
            Point2f((float)0.540147483, (float)-0.203156039),
            Point2f((float)0.529201686, (float)-0.199348077),
            Point2f((float)-0.248159677, (float)-0.254669130),
            Point2f((float)0.180369601, (float)-0.139303327),
            Point2f((float)0.570952237, (float)-0.185722873),
            Point2f((float)0.221771300, (float)-0.143187970),
            Point2f((float)0.498627752, (float)-0.183768719),
            Point2f((float)0.561214447, (float)-0.188666284),
            Point2f((float)-0.241409421, (float)-0.253560483),
            Point2f((float)0.569648385, (float)-0.184499770),
            Point2f((float)0.276665628, (float)-0.0881819800),
            Point2f((float)0.533934176, (float)-0.142226711),
            Point2f((float)-0.299728751, (float)-0.330407321),
            Point2f((float)0.270322412, (float)-0.256552309),
            Point2f((float)-0.255016476, (float)-0.0823200271),
            Point2f((float)-0.378096581, (float)0.0264666155),
            Point2f((float)-0.331565350, (float)0.0210608803),
            Point2f((float)0.0100810500, (float)-0.0213523544),
            Point2f((float)-0.248159677, (float)-0.254669130),
            Point2f((float)0.249623299, (float)0.164078355),
            Point2f((float)0.0190342199, (float)-0.00415771967),
            Point2f((float)0.604407132, (float)-0.259350061),
            Point2f((float)0.0660026148, (float)-0.00787150953),
            Point2f((float)0.605921566, (float)0.114344336),
            Point2f((float)0.0208173525, (float)0.00527517078),
            Point2f((float)-0.0200567022, (float)0.0183092188),
            Point2f((float)-0.184784368, (float)-0.193566754),
            Point2f((float)-0.0125719802, (float)-0.344967902),
            Point2f((float)0.343063682, (float)-0.0121044181),
            Point2f((float)0.389022052, (float)-0.0171062462),
            Point2f((float)0.163190305, (float)0.200014487),
            Point2f((float)0.362440646, (float)0.0120019922),
            Point2f((float)-0.427743971, (float)0.100272447),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)0.0664352402, (float)0.0467514023),
            Point2f((float)-0.559897065, (float)0.193362445),
            Point2f((float)-0.549086213, (float)0.193808615),
            Point2f((float)-0.241472989, (float)-0.253163874),
            Point2f((float)-0.241765827, (float)-0.0820638761),
            Point2f((float)-0.122216024, (float)0.132651567),
            Point2f((float)-0.122216024, (float)0.132651567),
            Point2f((float)0.515065968, (float)0.205271944),
            Point2f((float)0.180832058, (float)-0.127527758),
            Point2f((float)-0.123633556, (float)0.154476687),
            Point2f((float)-0.248159677, (float)-0.254669130),
            Point2f((float)0.0208173525, (float)0.00527517078),
            Point2f((float)-0.483276874, (float)0.191274792),
            Point2f((float)-0.167928949, (float)0.200682297),
            Point2f((float)0.232745290, (float)-0.211950779),
            Point2f((float)-0.288701504, (float)-0.334238827),
            Point2f((float)-0.119621970, (float)0.204155236),
            Point2f((float)-0.119621970, (float)0.204155236),
            Point2f((float)0.632996142, (float)0.0804972649),
            Point2f((float)0.189231426, (float)0.164325386),
            Point2f((float)0.249623299, (float)0.164078355),
            Point2f((float)0.0676716864, (float)0.0479496233),
            Point2f((float)0.207636267, (float)0.184271768),
            Point2f((float)-0.300510556, (float)0.358790994),
            Point2f((float)-0.107678331, (float)0.188473806),
            Point2f((float)0.565983415, (float)0.144723341),
            Point2f((float)0.191329703, (float)0.213909492),
            Point2f((float)-0.0283227600, (float)-0.373237878),
            Point2f((float)-0.184958130, (float)0.200373843),
            Point2f((float)0.0346363746, (float)-0.0259889495),
            Point2f((float)-0.112387165, (float)-0.167135969),
            Point2f((float)0.251426309, (float)0.210430339),
            Point2f((float)-0.477397382, (float)-0.131372169),
            Point2f((float)-0.0667442903, (float)0.0997460634),
            Point2f((float)0.251426309, (float)0.210430339),
            Point2f((float)-0.317926824, (float)0.375238001),
            Point2f((float)-0.0621999837, (float)0.280056626),
            Point2f((float)0.0443522707, (float)0.321513236),
            Point2f((float)0.471269101, (float)0.260774940),
            Point2f((float)-0.107678331, (float)0.188473806),
            Point2f((float)0.0208210852, (float)0.350526422),
            Point2f((float)0.0157474391, (float)0.367335707),
            Point2f((float)0.632996142, (float)0.0804972649),
            Point2f((float)0.646697879, (float)0.265504390),
            Point2f((float)0.0295150280, (float)0.371205181),
            Point2f((float)0.376071006, (float)0.313471258),
            Point2f((float)-0.379525930, (float)0.364357829),
            Point2f((float)-0.00628023129, (float)-0.0373278372),
            Point2f((float)0.0291138459, (float)0.381194293),
            Point2f((float)0.0358079821, (float)0.381886899),
            Point2f((float)0.0344478637, (float)0.386993408),
            Point2f((float)0.433862329, (float)0.328515977),
            Point2f((float)0.359724253, (float)0.345606029),
            Point2f((float)0.0651357397, (float)0.397334814),
            Point2f((float)0.388413996, (float)0.344747871),
            Point2f((float)-0.140228778, (float)0.216103494),
            Point2f((float)0.389989913, (float)0.372472703),
            Point2f((float)0.444995403, (float)0.300240308),
            Point2f((float)-0.606455386, (float)0.100793049),
            Point2f((float)-0.362332910, (float)-0.371920794),
            Point2f((float)-0.478956074, (float)0.234040022),
            Point2f((float)-0.289441198, (float)-0.344822973),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)0.375879139, (float)-0.374975592),
            Point2f((float)0.376526117, (float)-0.326493502),
            Point2f((float)0.313251913, (float)-0.306372881),
            Point2f((float)-0.0577337518, (float)0.0893306211),
            Point2f((float)-0.483683407, (float)-0.179540694),
            Point2f((float)-0.0763650239, (float)-0.258294433),
            Point2f((float)0.276665628, (float)-0.0881819800),
            Point2f((float)-0.167122558, (float)-0.175508693),
            Point2f((float)-0.164081737, (float)0.176902041),
            Point2f((float)0.276665628, (float)-0.0881819800),
            Point2f((float)0.602967978, (float)-0.260941893),
            Point2f((float)0.158573851, (float)-0.178748295),
            Point2f((float)0.159815103, (float)-0.160761341),
            Point2f((float)0.194283918, (float)-0.165657878),
            Point2f((float)0.231515527, (float)-0.172808051),
            Point2f((float)-0.247000366, (float)0.277822912),
            Point2f((float)0.538969517, (float)-0.204621449),
            Point2f((float)0.531404376, (float)-0.198565826),
            Point2f((float)-0.388338953, (float)-0.0433262810),
            Point2f((float)0.499413073, (float)-0.181929186),
            Point2f((float)-0.237337112, (float)0.0934364349),
            Point2f((float)-0.368045300, (float)-0.0204487685),
            Point2f((float)-0.374767631, (float)-0.00678646797),
            Point2f((float)-0.0667242110, (float)-0.248651102),
            Point2f((float)-0.248159677, (float)-0.254669130),
            Point2f((float)-0.345217139, (float)-0.00101677026),
            Point2f((float)-0.353382975, (float)0.0210586078),
            Point2f((float)-0.322639942, (float)0.0211628731),
            Point2f((float)0.0184581745, (float)-0.0366852731),
            Point2f((float)0.0259528626, (float)-0.0136881955),
            Point2f((float)-0.339446336, (float)0.0286702402),
            Point2f((float)0.0335014127, (float)-0.0271516014),
            Point2f((float)0.465966076, (float)0.0830826238),
            Point2f((float)-0.337860256, (float)0.0362124667),
            Point2f((float)0.188271523, (float)-0.146541893),
            Point2f((float)-0.298272073, (float)-0.323130161),
            Point2f((float)0.0643569306, (float)-0.0264105909),
            Point2f((float)-0.353804410, (float)0.0433940105),
            Point2f((float)0.618646920, (float)-0.0855877250),
            Point2f((float)0.411329508, (float)-0.0414552018),
            Point2f((float)-0.427743971, (float)0.100272447),
            Point2f((float)-0.247000366, (float)0.277822912),
            Point2f((float)0.381912649, (float)-0.00914942939),
            Point2f((float)0.0664352402, (float)0.0467514023),
            Point2f((float)0.138687640, (float)-0.114854909),
            Point2f((float)-0.0170480162, (float)-0.372787565),
            Point2f((float)-0.535477102, (float)0.183755845),
            Point2f((float)-0.155668780, (float)0.144164801),
            Point2f((float)-0.427504510, (float)0.105302416),
            Point2f((float)-0.484430760, (float)0.227277100),
            Point2f((float)-0.361284673, (float)-0.373513311),
            Point2f((float)-0.316764563, (float)0.331503242),
            Point2f((float)-0.0230990555, (float)0.314180285),
            Point2f((float)0.101539977, (float)-0.256640851),
            Point2f((float)-0.210743994, (float)-0.111771651),
            Point2f((float)-0.560086846, (float)0.151153624),
            Point2f((float)0.542884171, (float)0.141691014),
            Point2f((float)0.596041858, (float)0.144990161),
            Point2f((float)0.239398748, (float)0.207432285),
            Point2f((float)0.557545543, (float)0.155783832),
            Point2f((float)0.233033463, (float)0.214694947),
            Point2f((float)0.572789013, (float)0.162068501),
            Point2f((float)0.512761712, (float)0.176260322),
            Point2f((float)0.287076950, (float)0.0868823677),
            Point2f((float)0.515065968, (float)0.205271944),
            Point2f((float)0.552475691, (float)0.198386014),
            Point2f((float)-0.301232725, (float)0.347804308),
            Point2f((float)-0.379525930, (float)0.364357829),
            Point2f((float)0.561403453, (float)0.206571117),
            Point2f((float)0.590792358, (float)0.206283644),
            Point2f((float)-0.428855836, (float)0.100270294),
            Point2f((float)0.300039053, (float)-0.283949375),
            Point2f((float)0.0481642894, (float)0.334260821),
            Point2f((float)-0.173260480, (float)-0.167126089),
            Point2f((float)0.444995403, (float)0.300240308),
            Point2f((float)0.646697879, (float)0.265504390),
            Point2f((float)0.375487208, (float)0.314186513),
            Point2f((float)0.0217850581, (float)0.381838262),
            Point2f((float)0.404422343, (float)0.313856274),
            Point2f((float)0.417644382, (float)0.314869910),
            Point2f((float)0.0358079821, (float)0.381886899),
            Point2f((float)0.378262609, (float)0.358303785),
            Point2f((float)-0.336999178, (float)-0.367679387),
            Point2f((float)-0.295442462, (float)-0.365161836),
            Point2f((float)-0.293496192, (float)-0.342732310),
            Point2f((float)-0.298767596, (float)-0.303165644),
            Point2f((float)-0.0111337993, (float)-0.342149645),
            Point2f((float)0.310648471, (float)-0.374146342),
            Point2f((float)0.359467417, (float)-0.373746723),
            Point2f((float)0.340779394, (float)-0.369219989),
            Point2f((float)-0.527450860, (float)-0.203896046),
            Point2f((float)-0.490746915, (float)-0.194764644),
            Point2f((float)0.314866364, (float)-0.300261766),
            Point2f((float)-0.0298556220, (float)0.0591949411),
            Point2f((float)0.319549739, (float)0.0552458987),
            Point2f((float)0.163977623, (float)-0.209844783),
            Point2f((float)-0.149107113, (float)-0.149005055),
            Point2f((float)0.212483421, (float)-0.191198543),
            Point2f((float)0.197611198, (float)-0.187811792),
            Point2f((float)0.174361721, (float)-0.179897651),
            Point2f((float)0.0387913659, (float)-0.0366905928),
            Point2f((float)-0.122265801, (float)-0.126270071),
            Point2f((float)0.211038783, (float)-0.172842503),
            Point2f((float)0.246728286, (float)0.134398326),
            Point2f((float)-0.0577337518, (float)0.0893306211),
            Point2f((float)-0.415295422, (float)0.105914228),
            Point2f((float)-0.292730510, (float)0.0379575789),
            Point2f((float)0.489636958, (float)-0.194117576),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)0.336177140, (float)0.305443168),
            Point2f((float)0.526942134, (float)-0.164069965),
            Point2f((float)0.524966419, (float)-0.165161178),
            Point2f((float)-0.379173398, (float)0.332068861),
            Point2f((float)-0.340792000, (float)0.00105464540),
            Point2f((float)0.525632977, (float)-0.134992197),
            Point2f((float)-0.308774501, (float)0.00290521770),
            Point2f((float)-0.375407755, (float)0.0294080544),
            Point2f((float)0.0178439785, (float)-0.0365749858),
            Point2f((float)-0.255016476, (float)-0.0823200271),
            Point2f((float)-0.359951973, (float)0.0446678996),
            Point2f((float)0.0564084686, (float)-0.0197724514),
            Point2f((float)-0.315141559, (float)0.0424463004),
            Point2f((float)0.292196661, (float)0.279810339),
            Point2f((float)-0.345294952, (float)0.0533128195),
            Point2f((float)0.0458479226, (float)-0.00109126628),
            Point2f((float)0.0179449394, (float)0.00371767790),
            Point2f((float)0.365872562, (float)-0.0412087664),
            Point2f((float)0.403013051, (float)-0.0416624695),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)-0.209011748, (float)0.133690849),
            Point2f((float)0.0122421598, (float)0.0230175443),
            Point2f((float)-0.0577337518, (float)0.0893306211),
            Point2f((float)-0.572846889, (float)0.141102776),
            Point2f((float)0.345340014, (float)-0.0111671211),
            Point2f((float)0.0479373708, (float)0.0379454680),
            Point2f((float)0.363291621, (float)-0.00829032529),
            Point2f((float)0.381912649, (float)-0.00914942939),
            Point2f((float)-0.521542430, (float)0.151489466),
            Point2f((float)0.345966965, (float)0.0110620018),
            Point2f((float)0.354562849, (float)0.0254590791),
            Point2f((float)0.334322065, (float)0.0310698878),
            Point2f((float)-0.00463629747, (float)-0.0357710384),
            Point2f((float)-0.538667142, (float)0.185365483),
            Point2f((float)-0.209011748, (float)0.133690849),
            Point2f((float)0.398122877, (float)0.0403857268),
            Point2f((float)-0.160881191, (float)0.145009249),
            Point2f((float)-0.155668780, (float)0.144164801),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)-0.536377013, (float)0.221241340),
            Point2f((float)-0.0632879063, (float)-0.247039422),
            Point2f((float)-0.155869946, (float)0.169341147),
            Point2f((float)0.578685045, (float)-0.223878756),
            Point2f((float)0.557447612, (float)0.0768704116),
            Point2f((float)-0.188812047, (float)0.228197843),
            Point2f((float)0.246747240, (float)0.136472240),
            Point2f((float)-0.142677084, (float)0.213736445),
            Point2f((float)-0.118143238, (float)0.208306640),
            Point2f((float)-0.388338953, (float)-0.0433262810),
            Point2f((float)-0.163515776, (float)0.231573820),
            Point2f((float)-0.0738375857, (float)-0.256104171),
            Point2f((float)0.173092276, (float)0.191535592),
            Point2f((float)0.208548918, (float)0.185476139),
            Point2f((float)-0.392410189, (float)0.0686017647),
            Point2f((float)0.555366814, (float)0.130478472),
            Point2f((float)-0.101943128, (float)-0.113997340),
            Point2f((float)0.0716935173, (float)0.340265751),
            Point2f((float)0.561738014, (float)0.148283109),
            Point2f((float)0.242452115, (float)0.205116034),
            Point2f((float)0.561738014, (float)0.148283109),
            Point2f((float)-0.427743971, (float)0.100272447),
            Point2f((float)0.578137994, (float)0.163653031),
            Point2f((float)0.251277626, (float)0.223055005),
            Point2f((float)-0.376505047, (float)0.343530416),
            Point2f((float)-0.0714842379, (float)-0.0832463056),
            Point2f((float)0.567448437, (float)0.207419440),
            Point2f((float)0.590792358, (float)0.206283644),
            Point2f((float)0.578685045, (float)-0.223878756),
            Point2f((float)0.0635343120, (float)-0.00499309227),
            Point2f((float)-0.370767444, (float)0.384881169),
            Point2f((float)-0.485191971, (float)-0.120962359),
            Point2f((float)0.512761712, (float)0.176260322),
            Point2f((float)-0.375972956, (float)0.0288736783),
            Point2f((float)-0.147176415, (float)-0.185790271),
            Point2f((float)0.0752977654, (float)0.339190871),
            Point2f((float)0.646697879, (float)0.265504390),
            Point2f((float)0.0282997675, (float)0.373214334),
            Point2f((float)0.410353780, (float)0.316089481),
            Point2f((float)0.417644382, (float)0.314869910),
            Point2f((float)0.0147482762, (float)0.389459789),
            Point2f((float)-0.182916895, (float)-0.140514761),
            Point2f((float)0.433515042, (float)0.330774426),
            Point2f((float)0.388069838, (float)0.347381502),
            Point2f((float)0.378925055, (float)0.357438952),
            Point2f((float)0.247128293, (float)-0.116897359),
            Point2f((float)-0.0230906308, (float)0.314556211),
            Point2f((float)0.388534039, (float)0.370789021),
            Point2f((float)-0.368050814, (float)-0.339653373),
            Point2f((float)-0.292694926, (float)-0.341653705),
            Point2f((float)-0.353774697, (float)-0.320387989),
            Point2f((float)0.599263310, (float)-0.264537901),
            Point2f((float)-0.0213720929, (float)-0.326088905),
            Point2f((float)-0.571947694, (float)0.141147330),
            Point2f((float)-0.0577337518, (float)0.0893306211),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)-0.0317604132, (float)-0.0458168685),
            Point2f((float)-0.0967136100, (float)0.242639020),
            Point2f((float)-0.486509413, (float)-0.204596937),
            Point2f((float)0.239178345, (float)-0.219647482),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)-0.280393064, (float)-0.283867925),
            Point2f((float)-0.533659995, (float)-0.151733354),
            Point2f((float)0.0880429000, (float)-0.240412414),
            Point2f((float)-0.534965396, (float)-0.124174178),
            Point2f((float)0.142445788, (float)-0.118948005),
            Point2f((float)0.0947291106, (float)0.0767719224),
            Point2f((float)-0.597055852, (float)-0.0692315027),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)-0.308869720, (float)0.00354974205),
            Point2f((float)-0.409894019, (float)-0.0694356859),
            Point2f((float)0.556049764, (float)-0.137727231),
            Point2f((float)-0.0317604132, (float)-0.0458168685),
            Point2f((float)-0.524152219, (float)0.239541322),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)0.0143662402, (float)-0.0164190196),
            Point2f((float)0.150936082, (float)0.128616557),
            Point2f((float)0.618646920, (float)-0.0855877250),
            Point2f((float)0.0122421598, (float)0.0230175443),
            Point2f((float)0.0122421598, (float)0.0230175443),
            Point2f((float)-0.188812047, (float)0.228197843),
            Point2f((float)0.00441747159, (float)-0.297387213),
            Point2f((float)-0.520719767, (float)0.152393058),
            Point2f((float)0.392849416, (float)0.00738697406),
            Point2f((float)0.400074363, (float)0.0185570847),
            Point2f((float)-0.161484867, (float)-0.192373112),
            Point2f((float)-0.554901838, (float)0.190730989),
            Point2f((float)-0.538667142, (float)0.185365483),
            Point2f((float)-0.0667442903, (float)0.0997460634),
            Point2f((float)0.399885803, (float)0.0410231315),
            Point2f((float)-0.159816831, (float)0.145826310),
            Point2f((float)-0.193316415, (float)0.161277503),
            Point2f((float)-0.0678345188, (float)0.287081748),
            Point2f((float)-0.383089483, (float)-0.283330113),
            Point2f((float)-0.538667142, (float)0.185365483),
            Point2f((float)0.245664895, (float)0.162005231),
            Point2f((float)0.173092276, (float)0.191535592),
            Point2f((float)0.601281762, (float)0.120500855),
            Point2f((float)0.208548918, (float)0.185476139),
            Point2f((float)0.246893004, (float)0.220670119),
            Point2f((float)0.516039073, (float)0.178782418),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)-0.0230990555, (float)0.314180285),
            Point2f((float)0.610029638, (float)0.227215171),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)0.0697976872, (float)0.343245506),
            Point2f((float)0.538969517, (float)-0.204621449),
            Point2f((float)0.00916308723, (float)0.359826297),
            Point2f((float)0.410353780, (float)0.316089481),
            Point2f((float)0.423950195, (float)0.324112266),
            Point2f((float)0.166566655, (float)0.145402640),
            Point2f((float)0.354594171, (float)0.350193948),
            Point2f((float)0.433712035, (float)0.356235564),
            Point2f((float)0.425307065, (float)0.364637494),
            Point2f((float)0.166924104, (float)-0.152513608),
            Point2f((float)0.594130874, (float)-0.268246830),
            Point2f((float)-0.0843627378, (float)-0.0962528363),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)0.00760878995, (float)-0.304247797),
            Point2f((float)-0.471018314, (float)-0.178305879),
            Point2f((float)-0.0817007348, (float)-0.0933016762),
            Point2f((float)0.232274890, (float)0.154553935),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)-0.525787771, (float)-0.161353886),
            Point2f((float)-0.206048280, (float)0.241006181),
            Point2f((float)-0.178062543, (float)-0.184703678),
            Point2f((float)0.105906568, (float)0.268231422),
            Point2f((float)-0.0817007348, (float)-0.0933016762),
            Point2f((float)0.490914792, (float)0.276718110),
            Point2f((float)-0.176861435, (float)-0.153617889),
            Point2f((float)0.0387795344, (float)0.0457828715),
            Point2f((float)0.456206828, (float)-0.250739783),
            Point2f((float)0.0982551053, (float)0.104225174),
            Point2f((float)0.142445788, (float)-0.118948005),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)-0.0817007348, (float)-0.0933016762),
            Point2f((float)-0.340707630, (float)0.00498990202),
            Point2f((float)0.0947291106, (float)0.0767719224),
            Point2f((float)0.169802040, (float)0.203134149),
            Point2f((float)0.577375948, (float)-0.125099033),
            Point2f((float)0.318376005, (float)-0.0486588739),
            Point2f((float)0.388697982, (float)-0.0351444185),
            Point2f((float)0.406605273, (float)-0.0364143848),
            Point2f((float)0.274859309, (float)0.0776181892),
            Point2f((float)0.349759877, (float)-7.70174083e-05),
            Point2f((float)0.402967423, (float)0.00697830878),
            Point2f((float)0.105906568, (float)0.268231422),
            Point2f((float)0.338973522, (float)0.0359939188),
            Point2f((float)0.394951165, (float)0.0322254188),
            Point2f((float)-0.503028810, (float)0.203627899),
            Point2f((float)-0.0840740278, (float)-0.234684706),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)0.286642373, (float)0.103878126),
            Point2f((float)-0.0817007348, (float)-0.0933016762),
            Point2f((float)0.332983583, (float)-0.0356097035),
            Point2f((float)0.628004134, (float)0.0766527727),
            Point2f((float)-0.112659439, (float)-0.196833044),
            Point2f((float)0.568797410, (float)0.136423931),
            Point2f((float)0.456206828, (float)-0.250739783),
            Point2f((float)-0.254337519, (float)0.0937413648),
            Point2f((float)-0.206692874, (float)-0.210832119),
            Point2f((float)0.550912619, (float)0.171586066),
            Point2f((float)0.581267595, (float)0.213235661),
            Point2f((float)0.334484309, (float)0.303876013),
            Point2f((float)-0.469516128, (float)0.0883551016),
            Point2f((float)0.133899942, (float)0.106862970),
            Point2f((float)-0.560961962, (float)-0.114681393),
            Point2f((float)-0.0840740278, (float)-0.234684706),
            Point2f((float)0.459386230, (float)-0.236088052),
            Point2f((float)0.594130874, (float)-0.268246830),
            Point2f((float)-0.124856450, (float)0.193096936),
            Point2f((float)-0.469516128, (float)0.0883551016),
            Point2f((float)0.514290810, (float)-0.193822652),
            Point2f((float)0.158255994, (float)0.233290926),
            Point2f((float)0.317973822, (float)-0.0477817170),
            Point2f((float)-0.0817007348, (float)-0.0933016762),
            Point2f((float)-0.0702776462, (float)-0.0671426803),
            Point2f((float)0.440836668, (float)-0.100193374),
            Point2f((float)0.326240778, (float)0.0523138903),
            Point2f((float)-0.279556662, (float)-0.283929169),
            Point2f((float)-0.485202312, (float)-0.135626689),
            Point2f((float)-0.467358112, (float)0.246376559),
            Point2f((float)0.232274890, (float)0.154553935),
            Point2f((float)0.258349210, (float)-0.269529581),
            Point2f((float)0.600620329, (float)0.126268178),
            Point2f((float)-0.0985416993, (float)0.245674044),
            Point2f((float)-0.279264033, (float)-0.0990248993),
            Point2f((float)0.108424753, (float)-0.267108470),
            Point2f((float)0.259638488, (float)-0.100053802),
            Point2f((float)0.605106652, (float)0.223564968),
            Point2f((float)0.129683495, (float)-0.100376993),
            Point2f((float)-0.0953388065, (float)0.112722203),
            Point2f((float)-0.440420747, (float)-0.0396305211),
            Point2f((float)-0.0181254297, (float)0.0439292751),
            Point2f((float)-0.0878356919, (float)0.0847257674),
            Point2f((float)-0.271582603, (float)0.126064256),
            Point2f((float)-0.183777973, (float)-0.124357253),
            Point2f((float)0.431088895, (float)0.0680654719),
            Point2f((float)-0.469516128, (float)0.0883551016),
            Point2f((float)-0.445174575, (float)0.133306518),
            Point2f((float)-0.0878356919, (float)0.0847257674),
            Point2f((float)-0.279039949, (float)0.0810008645),
            Point2f((float)0.612402737, (float)-0.0826834291),
            Point2f((float)-0.454494953, (float)0.122878648),
            Point2f((float)0.244000912, (float)-0.264438629),
            Point2f((float)0.142445788, (float)-0.118948005),
            Point2f((float)0.129683495, (float)-0.100376993),
            Point2f((float)-0.210078895, (float)0.131698489),
            Point2f((float)-0.277847171, (float)0.0665081516),
            Point2f((float)0.431088895, (float)0.0680654719),
            Point2f((float)0.252345473, (float)0.0688349009),
            Point2f((float)0.133899942, (float)0.106862970),
            Point2f((float)0.133899942, (float)0.106862970),
            Point2f((float)-0.486509413, (float)-0.204596937),
            Point2f((float)-0.0940247625, (float)0.0698821172),
            Point2f((float)0.133899942, (float)0.106862970),
            Point2f((float)-0.440420747, (float)-0.0396305211),
            Point2f((float)-0.0878356919, (float)0.0847257674),
            Point2f((float)-0.0954068601, (float)-0.0968973264),
            Point2f((float)-0.277847171, (float)0.0665081516),
            Point2f((float)-0.277847171, (float)0.0665081516),
            Point2f((float)0.266677618, (float)0.111257851),
            Point2f((float)0.292424291, (float)-0.230888903),
            Point2f((float)-0.0954068601, (float)-0.0968973264)
        };

        vector<Point2f> prevRectifiedPoints(prevRectifiedPointArr, prevRectifiedPointArr + sizeof(prevRectifiedPointArr) / sizeof(prevRectifiedPointArr[0]));

        _prevRectifiedPoints.swap(prevRectifiedPoints);

        int validSolutionArr[2] = { 0, 2 };

        vector<int> validSolutions(validSolutionArr, validSolutionArr + sizeof(validSolutionArr) / sizeof(validSolutionArr[0]));

        _validSolutions.swap(validSolutions);

        vector<Mat> rotations;

        vector<Mat> normals;

        for (size_t i = 0; i < (sizeof(rotationsArray) / sizeof(*rotationsArray)); i++) {
            Mat tempRotMat = Mat(Matx33d(
                rotationsArray[i][0],
                rotationsArray[i][1],
                rotationsArray[i][2],
                rotationsArray[i][3],
                rotationsArray[i][4],
                rotationsArray[i][5],
                rotationsArray[i][6],
                rotationsArray[i][7],
                rotationsArray[i][8]
            ));

            Mat tempNormMat = Mat(Matx31d(
                normalsArray[i][0],
                normalsArray[i][1],
                normalsArray[i][2]
            ));

            rotations.push_back(tempRotMat);
            normals.push_back(tempNormMat);
        }

        _rotations.swap(rotations);
        _normals.swap(normals);

        _mask = Mat(514, 1, CV_8U, maskArray).clone();
    }

    bool isValidResult(vector<int> solutions)
    {
        return (solutions == _validSolutions);
    }

    vector<int> _validSolutions;
    vector<Point2f> _prevRectifiedPoints, _currRectifiedPoints;
    Mat _mask;
    vector<Mat> _rotations, _normals;
};

TEST(Calib3d_FilterDecomposeHomography, regression) { CV_FilterHomographyDecompTest test; test.safe_run(); }
